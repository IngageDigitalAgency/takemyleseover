name: CodeRabbit Review

on:
  pull_request:
    types: [opened, synchronize, reopened]
  workflow_dispatch:

jobs:
  coderabbit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Check CodeRabbit status
        run: |
          echo "CodeRabbit configuration files:"
          ls -la .coderabbit* .github/coderabbit* 2>/dev/null || echo "No CodeRabbit config found"
          
      - name: Validate YAML
        run: |
          if [ -f ".coderabbit.yaml" ]; then
            python -c "import yaml; yaml.safe_load(open('.coderabbit.yaml', 'r'))" || echo "Invalid YAML in .coderabbit.yaml"
          fi
          if [ -f ".github/coderabbit.yaml" ]; then
            python -c "import yaml; yaml.safe_load(open('.github/coderabbit.yaml', 'r'))" || echo "Invalid YAML in .github/coderabbit.yaml"
          fi